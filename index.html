<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vedam Classes</title>

  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #0b1222;
      color: white;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }

    .class-image {
      width: 100%;
      border-radius: 8px;
      margin-bottom: 15px;
    }

    .audio-player {
      width: 100%;
      margin-top: 10px;
    }

    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    button {
      padding: 10px 14px;
      background-color: #001f3f;
      color: white;
      border: 1px solid #445;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #003366;
    }

    .track-label {
      margin-top: 8px;
      background: #001a2c;
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 14px;
    }

    /* NEW: Track buttons */
    .track-list {
      margin-bottom: 10px;
    }

    .track-button {
      padding: 6px 10px;
      margin-right: 6px;
      margin-bottom: 6px;
      font-size: 13px;
      border-radius: 6px;
      border: 1px solid #445;
      background-color: #001a2c;
      color: #cfe6ff;
      cursor: pointer;
    }

    .track-button.active {
      background-color: #0074d9;
      color: white;
      border-color: #66aaff;
    }
  </style>

  <script src="data.js"></script>
</head>

<body>
  <div class="container">
    <h2 id="session-date"></h2>

    <img id="class-image" class="class-image" src="" alt="" />

    <!-- Audio section with multiple track buttons -->
    <div id="track-list" class="track-list"></div>

    <div class="track-label" id="track-label">Class Recording</div>

    <audio id="audio-player" class="audio-player" controls>
      <source id="audio-source" src="" type="audio/ogg" />
      Your browser does not support the audio element.
    </audio>

    <div class="nav-buttons">
      <button id="prev-btn">Previous</button>
      <button id="next-btn">Next</button>
    </div>
  </div>

  <script>
    let currentIndex = 0;

    function renderClass(index) {
      const cls = window.vedamClasses[index];
      if (!cls) return;

      document.getElementById("session-date").textContent = cls.displayDate;

      const imageEl = document.getElementById("class-image");
      imageEl.src = cls.image;
      imageEl.alt = cls.imageAlt || "";

      const audioPlayerEl = document.getElementById("audio-player");
      const audioSourceEl = document.getElementById("audio-source");
      const trackLabelEl = document.getElementById("track-label");
      const trackListEl = document.getElementById("track-list");

      audioPlayerEl.pause();

      /* -----------------------------------------------
         MULTI-AUDIO SYSTEM
      ------------------------------------------------- */
      if (cls.audio && Array.isArray(cls.audio) && cls.audio.length > 0) {
        
        // Function to load a specific audio track
        function loadTrack(trackIndex) {
          const track = cls.audio[trackIndex];
          audioSourceEl.src = track.file;
          trackLabelEl.textContent = track.label;
          audioPlayerEl.load();

          // Highlight selected button
          [...trackListEl.children].forEach((btn, i) => {
            btn.classList.toggle("active", i === trackIndex);
          });
        }

        // Build clickable audio-track buttons
        trackListEl.innerHTML = "";
        cls.audio.forEach((track, i) => {
          const btn = document.createElement("button");
          btn.textContent = track.label;
          btn.className = "track-button";
          btn.addEventListener("click", () => loadTrack(i));
          trackListEl.appendChild(btn);
        });

        // Load the first track by default
        loadTrack(0);

      } else {
        trackListEl.innerHTML = "";
        audioSourceEl.src = "";
        trackLabelEl.textContent = "No recording for this date";
        audioPlayerEl.load();
      }
    }

    // Navigation buttons
    document.getElementById("prev-btn").addEventListener("click", () => {
      if (currentIndex > 0) {
        currentIndex--;
        renderClass(currentIndex);
      }
    });

    document.getElementById("next-btn").addEventListener("click", () => {
      if (currentIndex < window.vedamClasses.length - 1) {
        currentIndex++;
        renderClass(currentIndex);
      }
    });

    // Load the first session on page load
    renderClass(currentIndex);
  </script>
</body>
</html>
